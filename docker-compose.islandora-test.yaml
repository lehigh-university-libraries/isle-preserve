services:
  drupal:
    volumes:
      - ./drupal/rootfs/var/www/drupal/config:/var/www/drupal/config:z,rw,${CONSISTENCY}
  fabricator:
    volumes:
      - /mnt/islandora_staging:/data:r
      - /home/runner/etds:/home/runner/etds:r
  mariadb:
    image: mariadb:12.0.2-noble@sha256:5b6a1eac15b85b981a61afb89aea2a22bf76b5f58809d05f0bcc13ab6ec44cb8
    secrets:
      - source: DB_ROOT_PASSWORD
        target: MARIADB_ROOT_PASSWORD
    healthcheck:
      test: test /run/mysqld/mysqld.sock
  github-actions-runner:
    image: ghcr.io/lehigh-university-libraries/actions-runner:main
    environment:
      GITHUB_RUNNER_TOKEN: ${GITHUB_RUNNER_TOKEN}
      GITHUB_REPO: "https://github.com/lehigh-university-libraries/fabricator"
      LABELS: workbench
    volumes:
      - actions-runner-data:/app:rw
      - /mnt/islandora_staging:/mnt/islandora_staging:ro
      - /home/runner:/home/runner:rw
